<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ATE ORSNA</title>

  <!-- Tipograf√≠as estilo ATE Capital -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Roboto+Condensed:wght@400;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --verde-ate: #00923f;
      --verde-oscuro: #006b2d;
      --gris-fondo: #f3f4f5;
      --texto-principal: #222;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: "Roboto", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--gris-fondo);
      color: var(--texto-principal);
      display: flex;
      min-height: 100vh;
    }

    /* ====== SIDEBAR ====== */

    .sidebar {
      width: 260px;
      background: var(--verde-ate);
      color: #fff;
      padding: 24px 20px;
      display: flex;
      flex-direction: column;
      position: sticky;
      top: 0;
      height: 100vh;
    }

    .brand {
      display: flex;
      align-items: center;
      margin-bottom: 32px;
      gap: 12px;
    }

.brand-logo {
  width: 240px;
  height: auto;
}

.brand--vertical {
  flex-direction: column;
  align-items: center;
  text-align: center;
}

.brand-text-wrapper {
  margin-top: 10px;
}

    .brand-text-main {
      font-family: "Roboto Condensed", sans-serif;
      font-size: 1.6rem;
      font-weight: 700;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      line-height: 1.1;
    }

    .brand-text-sub {
      font-size: 0.9rem;
      opacity: 0.9;
      margin-top: 4px;
    }

    nav h2 {
      font-family: "Roboto Condensed", sans-serif;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      opacity: 0.9;
      margin-bottom: 10px;
    }

    .nav-list {
      list-style: none;
    }

    .nav-list li {
      margin-bottom: 6px;
    }

    .nav-link {
      display: block;
      padding: 10px 12px;
      border-radius: 6px;
      text-decoration: none;
      color: #fff;
      font-size: 0.98rem;
      font-weight: 500;
      transition: background 0.2s, transform 0.1s;
    }

    .nav-link:hover {
      background: rgba(0, 0, 0, 0.16);
      transform: translateX(2px);
    }

    .nav-link--primary {
      background: var(--verde-oscuro);
    }

    .sidebar-footer {
      margin-top: auto;
      font-size: 0.8rem;
      opacity: 0.85;
      line-height: 1.4;
    }

    /* ====== CONTENIDO ====== */

    .content {
      flex: 1;
      padding: 24px 32px;
      max-width: 1100px;
      margin: 0 auto;
    }

    .hero {
      margin-bottom: 32px;
      padding-bottom: 16px;
      border-bottom: 1px solid #ddd;
    }

    .hero-label {
      font-family: "Roboto Condensed", sans-serif;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--verde-ate);
      margin-bottom: 8px;
    }

    .hero-title {
      font-family: "Roboto Condensed", sans-serif;
      font-size: 2.1rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-bottom: 8px;
    }

    .hero-subtitle {
      font-size: 1rem;
      max-width: 640px;
      color: #444;
    }

    .hero-video {
      margin-top: 20px;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 10px 25px rgba(0,0,0,0.18);
    }

    .hero-video iframe {
      width: 100%;
      height: 360px;
      border: none;
      display: block;
    }

    section {
      margin-bottom: 32px;
    }

    section h2 {
      font-family: "Roboto Condensed", sans-serif;
      font-size: 1.4rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      margin-bottom: 10px;
      color: var(--verde-oscuro);
    }

    section p {
      font-size: 0.98rem;
      line-height: 1.6;
      color: #444;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 16px;
      margin-top: 10px;
    }

    .card {
      background: #fff;
      border-radius: 8px;
      padding: 16px 18px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.06);
    }

    .card h3 {
      font-family: "Roboto Condensed", sans-serif;
      font-size: 1.05rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-bottom: 6px;
    }

    .tag {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 999px;
      background: rgba(0,146,63,0.12);
      color: var(--verde-oscuro);
      font-size: 0.75rem;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-bottom: 8px;
    }

    .contact-list {
      list-style: none;
      font-size: 0.96rem;
      line-height: 1.7;
    }

    .contact-list strong {
      font-weight: 600;
    }

    .muted {
      font-size: 0.9rem;
      color: #777;
      margin-top: 8px;
    }

    /* ====== RESPONSIVE ====== */

    @media (max-width: 860px) {
      body {
        flex-direction: column;
      }
      .sidebar {
        position: relative;
        width: 100%;
        height: auto;
        flex-direction: row;
        align-items: center;
        padding: 12px 16px;
        gap: 16px;
      }
      .brand {
        margin-bottom: 0;
      }
      nav h2 {
        display: none;
      }
      .nav-list {
        display: flex;
        gap: 6px;
        flex-wrap: wrap;
      }
      .nav-link {
        padding: 8px 10px;
        font-size: 0.9rem;
      }
      .sidebar-footer {
        display: none;
      }
      .content {
        padding: 20px;
      }
      .hero-video iframe {
        height: 220px;
      }
    }
/* === Layout calculadora + tarjeta informe MATE === */
.layout-calculadora-informe {
  display: flex;
  gap: 24px;
  align-items: flex-start;   /* ya no fuerza la misma altura exacta */
  margin-top: 24px;
}

/* La calculadora sigue siendo el contenido principal (ocupa casi todo el ancho) */
.calculadora-contenedor {
  flex: 1 1 auto;
  max-width: 800px;  /* la mantenemos bien ancha dentro del contenido */
}

/* Tarjeta lateral del informe, m√°s angosta y secundaria */
.informe-mate {
  flex: 0 0 240px;   /* columna m√°s finita */
  background: #f8fafc;
  border-left: 3px solid var(--verde-ate);
  border-radius: 10px;
  padding: 12px 14px;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  color: #222;
  font-size: 0.9rem;
  margin-top: 12px;
}

/* El link es la imagen completa */
.informe-mate-link {
  display: block;
  border-radius: 8px;
  overflow: hidden;
  margin-bottom: 8px;
  border: 1px solid #e5e7eb;
}

.informe-mate-link:hover {
  border-color: var(--verde-ate);
  filter: brightness(1.03);
}

    .informe-mate-link:hover img {
  filter: brightness(1.04);
  transform: scale(1.01);
  transition: 0.2s;
}

.informe-mate-img {
  max-height: 300px;
  object-fit: contain;
}

.informe-mate h3 {
  margin: 0 0 6px 0;
  font-family: "Roboto Condensed", sans-serif;
  font-size: 0.8rem;
  text-transform: uppercase;
  letter-spacing: 0.06em;
  color: var(--verde-oscuro);
  margin-bottom: 4px;
}

.informe-mate p {
  font-size: 0.85rem;
  line-height: 1.4;
  margin: 0;
}

/* En pantallas chicas, que se apilen uno abajo del otro */
@media (max-width: 860px) {
  .layout-calculadora-informe {
    flex-direction: column;
    gap: 32px;
  }
.informe-mate {
  border-left: 4px solid #00923f;
  padding-left: 14px;
    border-radius: 0 10px 10px 0;
}

}


    /* === Ajuste espec√≠fico para achicar los contadores por a√±o === */
#gadget-salario-2016 .year-loss-item .counter {
  font-size: 0.9rem !important;  /* bien chiquito */
  line-height: 1.2;
}
/* Forzar tama√±o del contador rojo dentro de la tabla de p√©rdidas */
#yearLossContainer .year-loss-table td .counter {
  font-size: 0.85rem !important;
  font-weight: 700 !important;
  color: #ef4444 !important;
  line-height: 1.2 !important;
  white-space: nowrap !important;
}


  </style>
</head>
<body>

  <!-- BARRA LATERAL -->
  <aside class="sidebar">
<div class="brand brand--vertical">
  <img src="ateorsna.png" alt="ATE ORSNA" class="brand-logo">
  <div class="brand-text-wrapper">
    <div class="brand-text-main">ATE ORSNA</div>
    <div class="brand-text-sub">üá≥üá¨ üá≥üá¨</div>
  </div>
</div>


    <nav>
      <h2>Secciones</h2>
      <ul class="nav-list">
        <li><a class="nav-link nav-link--primary" href="#junta-interna">Junta Interna</a></li>
        <li><a class="nav-link" href="#publicaciones">Publicaciones</a></li>
        <li><a class="nav-link" href="#contacto">Contacto</a></li>
      </ul>
    </nav>

    <div class="sidebar-footer">
      Junta Interna de ATE ORSNA.
      <br>Pr√≥ximamente m√°s contenidos, informes y materiales gremiales.
    </div>
  </aside>

  <!-- CONTENIDO PRINCIPAL -->
  <main class="content">
    <header class="hero">
      <div class="hero-label">Sitio en construcci√≥n</div>
      <h1 class="hero-title">ATE ORSNA</h1>
      <p class="hero-subtitle">
        Esta es la p√°gina de la Junta Interna de ATE en el ORSNA.                        
        Un espacio para organizar, informar y defender nuestros derechos como trabajadoras y trabajadores del Organismo.
      </p>

      <!-- Contenedor: calculadora + tarjeta informe MATE -->
      <div class="layout-calculadora-informe">

        <!-- Caja de la CALCULADORA -->
        <div class="calculadora-contenedor">

<!-- ==== GADGET PODER ADQUISITIVO ‚Äì SALARIO ACTUAL + 3 CONTADORES + A√ëO A A√ëO ==== -->
<section id="gadget-salario-2016" class="salario-card">

  <h2>¬øCu√°nto poder adquisitivo perdiste desde diciembre de 2015?</h2>
  <p class="salario-subtitulo">
    Ingres√° tu salario actual y te mostramos cu√°nto perdimos por la falta de actualizaci√≥n paritaria  </p>

  <!-- FILA: INPUT + BOT√ìN AL LADO -->
<div class="salario-row">
  
  <div class="input-y-boton">
<input
  type="text"
  id="salarioActual"
  placeholder="ingrese un monto"
  inputmode="numeric"
  autocomplete="off">
  <button type="button" id="btnCalcularSalario">Calcular</button>
  </div>

  <small class="nota-sueldo">No se registra ning√∫n dato personal</small>
</div>


  <!-- CONTADORES PRINCIPALES -->
  <div id="bloquePerdidas" class="salario-bloque resultados" style="display:none;">
    <div class="perdidas-header">
      <img src="dineroseva.png" alt="Pesos con alas" class="icono-dinero">
      <img src="dineroseva.png" alt="Pesos con alas" class="icono-dinero">
    <img src="dineroseva.png" alt="Pesos con alas" class="icono-dinero">
    <img src="dineroseva.png" alt="Pesos con alas" class="icono-dinero">
    <img src="dineroseva.png" alt="Pesos con alas" class="icono-dinero">
    <img src="dineroseva.png" alt="Pesos con alas" class="icono-dinero">
    </div>

    <div class="loss-grid">
      <!-- 1) SUELDO IDEAL HOY -->
      <div class="loss-item principal">
        <div class="label-contador">Deber√≠as estar ganando hoy</div>
        <div class="counter counter-main" id="contadorDeberia" data-suffix=""></div>
      </div>

      <!-- 2) P√âRDIDA MENSUAL -->
      <div class="loss-item">
        <div class="label-contador">Perd√©s todos los meses</div>
        <div class="counter counter-neg" id="contadorPerdidaMensual" data-suffix="/mes"></div>
      </div>

      <!-- 3) P√âRDIDA TOTAL ACUMULADA -->
      <div class="loss-item">
        <div class="label-contador">Perdiste desde dic-2015</div>
        <div class="counter counter-neg" id="contadorPerdidaTotal" data-suffix=" acum."></div>
      </div>
    </div>

        <!-- P√âRDIDA EN PORCENTAJE HOY -->
<div class="percentage-loss" id="porcentajePerdidaWrapper" style="display:none;">
  <div class="percentage-loss-text">
    Tu sueldo actual deber√≠a crecer un <span id="porcentajePerdida"></span>
    para no perder contra la inflaci√≥n
  </div>
</div>


    <!-- P√âRDIDA POR A√ëO -->
    <div class="year-loss-container" id="yearLossContainer" style="display:none;">
      <div class="year-loss-title">P√©rdida acumulada por a√±o</div>
      <div class="year-loss-grid" id="yearLossGrid">
        <!-- ac√° se llenan din√°micamente los contadores por a√±o -->
      </div>
    </div>
  </div>
</section>

<style>
  /* === Estilos del gadget === */
  #gadget-salario-2016.salario-card {
    margin: 2rem auto;
    max-width: 1150px;              /* m√°s ancho */
    padding: 1.25rem 2.2rem;       /* m√°s baja */
    border-radius: 10px;
    background: #10212f;
    color: #ffffff !important;
    border: 1px solid rgba(148,163,184,0.5);
    font-family: system-ui, -apple-system, "Segoe UI", sans-serif;
  }

  #gadget-salario-2016 h2 {
    font-size: 1.4rem;
    margin-bottom: 0.4rem;
    color: #22c55e;   /* MISMO VERDE QUE EL CONTADOR PRINCIPAL */

  }

  #gadget-salario-2016 .salario-subtitulo {
    font-size: 0.9rem;
    color: #cbd5f5;
    margin-bottom: 0.8rem;
  }

  /* Fila con input y bot√≥n al lado */
.salario-row {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.5rem;
  margin-bottom: 1rem;
}


  .salario-col {
    flex: 1 1 260px;
    display: flex;
    flex-direction: column;
    gap: 0.35rem;
  }

  .salario-col label {
    font-size: 0.9rem;
    font-weight: 600;
  }

.salario-col input {
  width: 180px;          /* ANTES era autom√°tico ‚Üí ahora es chico */
  padding: 0.3rem 0.4rem;
  border-radius: 6px;
  border: 1px solid #64748b;
  background: #0b1720;
  color: #f9fafb;
  font-size: 0.85rem;     /* m√°s chico */
}


  .salario-col input:focus {
    outline: 2px solid #38bdf8;
    outline-offset: 1px;
  }

  .salario-col small {
    font-size: 0.75rem;
    color: #94a3b8;
  }

#btnCalcularSalario {
  padding: 0.4rem 1rem;     /* m√°s chico */
  border-radius: 999px;
  border: none;
  cursor: pointer;
  background: #22c55e;
  color: #052e16;
  font-weight: 600;
  font-size: 0.85rem;       /* m√°s peque√±o */
  white-space: nowrap;
}


  #btnCalcularSalario:hover {
    filter: brightness(1.05);
  }

  .salario-bloque.resultados {
    margin-top: 0.8rem;
    padding-top: 0.6rem;
    border-top: 1px solid rgba(148,163,184,0.5);
  }

  .perdidas-header {
    display: flex;
    justify-content: center;
    margin-bottom: 0.4rem;
  }

  .icono-dinero {
    max-width: 70px;
    height: auto;
    opacity: 0.9;
  }

  .input-y-boton input {
  width: 150px;          /* achicado */
  padding: 0.35rem 0.45rem;
  font-size: 0.9rem;
  border-radius: 6px;
  border: 1px solid #64748b;
  background: #0b1720;
  color: #f9fafb;
  text-align: right;
}

#btnCalcularSalario {
  padding: 0.35rem 0.9rem;
  font-size: 0.85rem;
  background: #22c55e;
  color: #052e16;
  border-radius: 999px;
  border: none;
  cursor: pointer;
  white-space: nowrap;
}

#btnCalcularSalario:hover {
  filter: brightness(1.05);
}

.nota-sueldo {
  font-size: 0.75rem;
  color: #94a3b8;
  text-align: center;
  max-width: 280px;
}
  /* Layout de los 3 contadores (caja m√°s chica a lo alto) */
  .loss-grid {
    display: grid;
    grid-template-columns: repeat(3, minmax(0,1fr));
    gap: 0.75rem;
    margin-bottom: 0.6rem;
  }

  .loss-item {
    text-align: center;
    padding: 0.3rem 0.25rem;
  }

  .loss-item.principal {
    border-right: 1px solid rgba(148,163,184,0.4);
  }

  @media (max-width: 700px) {
    .loss-grid {
      grid-template-columns: 1fr;
    }
    .loss-item.principal {
      border-right: none;
      border-bottom: 1px solid rgba(148,163,184,0.4);
    }
  }

  .label-contador {
    font-size: 0.8rem;
    color: #cbd5f5;
    margin-bottom: 0.15rem;
  }

  /* Estilo de contadores ‚Äì m√°s compactos */
  #gadget-salario-2016 .counter {
    font-size: 2rem;
    font-weight: 800;
    position: relative;
    display: inline-block;
    transition: color .3s ease;
    white-space: nowrap;  /* üëà evita que se corte en 2 renglones */
  }

  /* Un poquito m√°s chico solo en los 3 contadores grandes para que entren c√≥modos */
  #gadget-salario-2016 .loss-grid .counter {
    font-size: 1.8rem;
  }

  @media (max-width: 700px) {
    #gadget-salario-2016 .loss-grid .counter {
      font-size: 1.5rem;
    }
  }


  .counter-main {
    color: #22c55e;
  }

  .counter-neg {
    color: #ef4444; /* rojo */
  }

  #gadget-salario-2016 .counter.animate {
    filter: brightness(1.1);
  }

  #gadget-salario-2016 .counter::after {
    content: attr(data-suffix);
    font-size: 0.45em;
    margin-left: 6px;
    position: static;
    opacity: 0;
    transform: translateX(4px);
    transition: opacity .3s ease-out, transform .3s ease-out, color .3s ease;
  }

  #gadget-salario-2016 .counter.animate::after {
    opacity: 1;
    transform: translateX(0);
  }

  /* P√©rdida por a√±o */
  .year-loss-container {
    margin-top: 0.6rem;
    padding-top: 0.5rem;
    border-top: 1px dashed rgba(148,163,184,0.5);
  }

  .year-loss-title {
    font-size: 0.85rem;
    color: #cbd5f5;
    margin-bottom: 0.35rem;
    text-align: center;
  }

/* Contenedor de la tabla de p√©rdidas por a√±o */
.year-loss-grid {
  overflow-x: auto; /* si hay muchos a√±os, que se pueda scrollear horizontal */
}

/* Tabla: columnas = a√±os, filas = p√©rdida / inflaci√≥n / paritarias */
.year-loss-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.78rem;
  color: #e5e7eb;
  margin-top: 0.3rem;
}

.year-loss-table th,
.year-loss-table td {
  padding: 0.25rem 0.4rem;
  text-align: center;
  border-bottom: 1px solid rgba(148,163,184,0.25);
}

.year-loss-table th:first-child,
.year-loss-table td:first-child {
  text-align: left;
  white-space: nowrap;
  font-weight: 600;
  color: #cbd5f5;
}

.year-loss-row-label {
  white-space: nowrap;
}

@media (max-width: 600px) {
  .year-loss-table {
    font-size: 0.7rem;
  }
}


@media (max-width: 600px) {
  #gadget-salario-2016.salario-card {
    margin: 1rem;
    padding: 1.1rem 1rem;
  }
}
.year-inflation {
  font-size: 0.7rem;
  color: #cbd5f5;
  margin-top: 0.05rem;
}
.percentage-loss {
  margin-top: 0.4rem;
  margin-bottom: 0.2rem;
  padding: 0.4rem 0.7rem;
  border-radius: 999px;
  background: rgba(248, 113, 113, 0.12); /* rojito suave */
  border: 1px solid rgba(248, 113, 113, 0.45);
  text-align: center;
}

.percentage-loss-text {
  font-size: 0.85rem;
  color: #fee2e2;
}

#porcentajePerdida {
  font-weight: 700;
  color: #fca5a5;
}
.year-salary-var {
  font-size: 0.7rem;
  color: #bbf7d0;        /* verdecito suave para diferenciar de inflaci√≥n */
  margin-top: 0.05rem;
}

</style>

<script>
// Factor global de crecimiento salarial (dic-2015 -> hoy):
// lo seguimos usando para estimar el sueldo base a partir del sueldo actual.
let SALARIO_FACTOR = 49.15;

// IPC_FACTOR se calcula autom√°ticamente leyendo Docs/ipc.csv
let IPC_FACTOR = 1;              // se ajusta al cargar el CSV
let normalizedIndices = [];      // IPC_t / IPC_base
let normalizedYears = [];        // a√±o de cada fila (A√±o de tu CSV)

// Nuevos arrays / estructuras para √≠ndice salarial y precios
let rawIPC = [];                 // valores originales del √≠ndice IPC
let ipcYearMonth = [];           // strings "YYYY-MM"
let inflationByYear = {};        // { 2017: 24.5, 2018: 32.1, ... }

// √çndice salarial a partir de Varsueldo.csv
let salaryIndexNorm = [];        // √≠ndice salarial normalizado y escalado (base=1 en dic-2015)
let salaryYearMonth = [];        // "YYYY-MM" para cada fila de Varsueldo
let salaryYears = [];            // a√±o (number) para cada fila de Varsueldo

  // NUEVO: suma de Varsueldo (%) por a√±o
let salaryVariationByYear = {};  // { 2016: 45.3, 2017: 34.2, ... }
const CURRENT_YEAR = new Date().getFullYear();

// Formato para mostrar el salario ingresado con puntos de miles
const formatoEntero = new Intl.NumberFormat("es-AR", {
  maximumFractionDigits: 0
});

// Formatear el input mientras escribe
const salarioInput = document.getElementById("salarioActual");
salarioInput.addEventListener("input", function () {
  // Sacamos todo lo que no sea d√≠gito
  let raw = this.value.replace(/\D/g, "");
  if (raw === "") {
    this.value = "";
    return;
  }
  // Aplicamos formato con puntos de miles
  const num = parseInt(raw, 10);
  this.value = formatoEntero.format(num);
});

    // Permitir calcular con Enter dentro del input
salarioInput.addEventListener("keyup", function (e) {
  if (e.key === "Enter") {
    document.getElementById("btnCalcularSalario").click();
  }
});
  
// Formato general en pesos (para los 3 contadores grandes)
const formatoPesos = new Intl.NumberFormat("es-AR", {
  style: "currency",
  currency: "ARS",
  maximumFractionDigits: 0
});

// Formato para porcentaje (inflaci√≥n anual)
const formatoPorcentaje = new Intl.NumberFormat("es-AR", {
  minimumFractionDigits: 1,
  maximumFractionDigits: 1
});

const DURATION_MS = 2000; // duraci√≥n de la animaci√≥n del contador

// Animaci√≥n en pesos (contadores principales)
function animateMoneyCounter(el, target, options = {}) {
  const { negative = false } = options;
  const start = performance.now();
  const initial = 0;
  el.classList.remove("animate"); // reseteo

  function tick(now) {
    const t = Math.min(1, (now - start) / DURATION_MS);
    const eased = 1 - Math.pow(1 - t, 3);
    const value = Math.round(initial + (target - initial) * eased);

    const texto = formatoPesos.format(Math.abs(value));
    el.textContent = negative && value > 0 ? ("- " + texto) : texto;

    if (t < 1) {
      requestAnimationFrame(tick);
    } else {
      const finalTexto = formatoPesos.format(Math.abs(target));
      el.textContent = negative && target > 0 ? ("- " + finalTexto) : finalTexto;
      el.classList.add("animate");
    }
  }
  requestAnimationFrame(tick);
}

// Formato para mostrar montos en millones de pesos (ej: - $0,50 ; - $3,25)
const formatoMillones = new Intl.NumberFormat("es-AR", {
  style: "currency",
  currency: "ARS",
  minimumFractionDigits: 2,
  maximumFractionDigits: 2
});


// Animaci√≥n para valores en millones de pesos (sin texto "Mill")
function animateMillionsCounter(el, targetEnMillones, options = {}) {
  const { negative = false } = options;
  const start = performance.now();
  const initial = 0;
  el.classList.remove("animate");

  function tick(now) {
    const t = Math.min(1, (now - start) / DURATION_MS);
    const eased = 1 - Math.pow(1 - t, 3);
    const value = initial + (targetEnMillones - initial) * eased;

    const texto = formatoMillones.format(Math.abs(value)); // ej: $0,50
    el.textContent = (negative && value > 0)
      ? "- " + texto
      : texto;

    if (t < 1) {
      requestAnimationFrame(tick);
    } else {
      const finalTexto = formatoMillones.format(Math.abs(targetEnMillones));
      el.textContent = (negative && targetEnMillones > 0)
        ? "- " + finalTexto
        : finalTexto;
      el.classList.add("animate");
    }
  }

  requestAnimationFrame(tick);
}


// Leer Docs/ipc.csv y calcular:
// - IPC_FACTOR = IPC_√∫ltimo / IPC_base
// - normalizedIndices = IPC_t / IPC_base para cada fila
// - normalizedYears = a√±o de cada fila (A√±o de tu CSV)
(function cargarIPC() {
  fetch("Docs/ipc.csv")
    .then(resp => resp.text())
    .then(texto => {
      const lineas = texto.split(/\r?\n/).filter(l => l.trim().length > 0);
      if (lineas.length < 2) return;

      const valores = [];
      const years = [];
      const yearMonths = [];
      const ejemplo = lineas[1];
      const sep = ejemplo.includes(";") ? ";" : ",";

      for (let i = 1; i < lineas.length; i++) { // saltamos encabezado
        const partes = lineas[i].split(sep).map(p => p.trim());
        if (partes.length < 3) continue;

        const yearStr = partes[0];      // columna "A√±o"
        const ymStr   = partes[1];      // columna "A√±oMes" (ej: 2016-12)
        const year    = parseInt(yearStr, 10);

        const valorStr = partes[2].replace(",", ".");
        const v = parseFloat(valorStr);

        if (!isNaN(v) && !isNaN(year) && ymStr) {
          valores.push(v);
          years.push(year);
          yearMonths.push(ymStr);
        }
      }

      if (valores.length < 2) return;

      // Guardamos globalmente
      rawIPC          = valores;
      normalizedYears = years;
      ipcYearMonth    = yearMonths;

      // base = primer valor del CSV (en tu caso, dic-2015 empalmado)
      const base = valores[0];
      normalizedIndices = valores.map(v => v / base);
      IPC_FACTOR = normalizedIndices[normalizedIndices.length - 1];

      // ==== C√°lculo de inflaci√≥n anual:
      // usamos el √öLTIMO mes disponible de cada a√±o vs el √öLTIMO mes del a√±o anterior ====
      inflationByYear = {};

      // Mapear, para cada a√±o, el √∫ltimo √≠ndice donde aparece en la serie
      const perYearLastIndex = {};
      for (let i = 0; i < normalizedYears.length; i++) {
        const y = normalizedYears[i];
        perYearLastIndex[y] = i; // como recorre en orden, queda el √∫ltimo
      }

      const minYear = Math.min(...normalizedYears);
      const maxYear = Math.max(...normalizedYears);

      for (let y = minYear + 1; y <= maxYear; y++) {
        const idxAct  = perYearLastIndex[y];
        const idxPrev = perYearLastIndex[y - 1];

        if (idxAct == null || idxPrev == null) continue;

        const ipcAct  = rawIPC[idxAct];
        const ipcPrev = rawIPC[idxPrev];

        if (ipcPrev > 0) {
          const infl = (ipcAct / ipcPrev - 1) * 100;
          inflationByYear[y] = infl;
        }
      }

      console.log(
        "IPC_FACTOR:", IPC_FACTOR.toFixed(4),
        "filas IPC:", normalizedIndices.length,
        "a√±os en serie:", [...new Set(normalizedYears)].join(", "),
        "inflaci√≥n por a√±o:", inflationByYear
      );

    })
    .catch(err => {
      console.warn("No se pudo leer Docs/ipc.csv, se usan valores por defecto:", err);
      IPC_FACTOR = SALARIO_FACTOR;  // fallback para que no explote
      normalizedIndices = [1, IPC_FACTOR]; // base + un punto
      normalizedYears = [2015, CURRENT_YEAR];
      inflationByYear = {};
    });
})();

// Leer Docs/Varsueldo.csv y construir un √≠ndice salarial mensual
(function cargarVarsueldo() {
  fetch("Docs/Varsueldo.csv")
    .then(resp => resp.text())
    .then(texto => {
      const lineas = texto.split(/\r?\n/).filter(l => l.trim().length > 0);
      if (lineas.length < 2) return;

      const variaciones = [];
      const years = [];
      const yearMonths = [];
      
      // Reiniciamos el acumulador anual de paritarias
      salaryVariationByYear = {};

      const ejemplo = lineas[1];
      const sep = ejemplo.includes(";") ? ";" : ",";

      for (let i = 1; i < lineas.length; i++) { // salteamos encabezado
        const partes = lineas[i].split(sep).map(p => p.trim());
        if (partes.length < 2) continue;

        const periodo = partes[0];   // ej: "12/2015"
        const varStr  = partes[1];   // ej: "3,5%"

        // Parsear periodo MM/YYYY -> YYYY-MM
        const partesFecha = periodo.split("/");
        if (partesFecha.length !== 2) continue;
        const mesStr  = partesFecha[0].padStart(2, "0");
        const yearStr = partesFecha[1];
        const anio    = parseInt(yearStr, 10);
        if (isNaN(anio)) continue;

        const ym = `${yearStr}-${mesStr}`;  // "2015-12", "2016-01", etc.

        // Parsear porcentaje: "3,5%" -> 0.035
        const limpio = varStr.replace("%", "").replace(",", ".");
        const v = parseFloat(limpio);
        const varMensual = isNaN(v) ? 0 : (v / 100);

        years.push(anio);
        yearMonths.push(ym);
        variaciones.push(varMensual);

        // üëâ AC√Å adentro s√≠: acumular Varsueldo (%) por a√±o calendario
        if (!salaryVariationByYear[anio]) {
          salaryVariationByYear[anio] = 0;
        }
        salaryVariationByYear[anio] += varMensual * 100; // guardamos puntos porcentuales
      }

      if (!variaciones.length) return;

      // Construimos √≠ndice salarial crudo con base = 1 en el primer registro (dic-2015)
      const idxRaw = [];
      let nivel = 1;
      for (let i = 0; i < variaciones.length; i++) {
        if (i === 0) {
          idxRaw.push(1);
        } else {
          nivel = nivel * (1 + variaciones[i]);
          idxRaw.push(nivel);
        }
      }

      // Escalamos para que el √∫ltimo valor coincida con SALARIO_FACTOR
      const factorEndRaw = idxRaw[idxRaw.length - 1];
      let scale = 1;
      if (factorEndRaw > 0) {
        scale = SALARIO_FACTOR / factorEndRaw;
      }

      salaryIndexNorm = idxRaw.map(v => v * scale);
      salaryYearMonth = yearMonths;
      salaryYears     = years;

      console.log("√çndice salarial cargado. √öltimo factor (escalado) =", salaryIndexNorm[salaryIndexNorm.length - 1]);
      console.log("Paritarias por a√±o:", salaryVariationByYear);
    })
    .catch(err => {
      console.warn("No se pudo leer Docs/Varsueldo.csv. Se usar√° solo la aproximaci√≥n global.", err);
      salaryIndexNorm = [];
      salaryYearMonth = [];
      salaryYears     = [];
      salaryVariationByYear = {};
    });
})();


document.getElementById("btnCalcularSalario").addEventListener("click", function () {


  const salarioActualInput = document.getElementById("salarioActual");
  const salarioActual = parseFloat(
    String(salarioActualInput.value)
      .replace(/\./g, "")   // sacamos los puntos de miles
      .replace(",", ".")    // por si alg√∫n d√≠a hay coma
  );

  const bloquePerdidas = document.getElementById("bloquePerdidas");
  const yearLossContainer = document.getElementById("yearLossContainer");
  const yearLossGrid = document.getElementById("yearLossGrid");


  const contadorDeberia = document.getElementById("contadorDeberia");
  const contadorPerdidaMensual = document.getElementById("contadorPerdidaMensual");
  const contadorPerdidaTotal = document.getElementById("contadorPerdidaTotal");

  const porcentajePerdidaWrapper = document.getElementById("porcentajePerdidaWrapper");
  const porcentajePerdidaSpan = document.getElementById("porcentajePerdida");


  // Ocultamos resultados si algo est√° mal
  bloquePerdidas.style.display = "none";
  yearLossContainer.style.display = "none";
  yearLossGrid.innerHTML = "";
  porcentajePerdidaWrapper.style.display = "none";


  if (isNaN(salarioActual) || salarioActual <= 0) {
    alert("Por favor, ingres√° tu salario mensual actual.");
    return;
  }

  // 1) Estimar salario "base" (2015/2016) a partir del salario actual y SALARIO_FACTOR
  const salarioBaseEstimado = salarioActual / SALARIO_FACTOR;

  // 2) Sueldo ideal hoy (sin p√©rdida de poder adquisitivo)
  const salarioNecesarioHoy = salarioBaseEstimado * IPC_FACTOR;

  // 3) P√©rdida mensual hoy
  let perdidaMensual = salarioNecesarioHoy - salarioActual;
  if (perdidaMensual < 0) perdidaMensual = 0;
  
  // 3 bis) % de aumento necesario hoy para no perder contra la inflaci√≥n
  let porcentajePerdida = 0;
  if (salarioActual > 0) {
    // cu√°nto tiene que subir tu sueldo para llegar a salarioNecesarioHoy
    porcentajePerdida = (salarioNecesarioHoy / salarioActual - 1) * 100;
    if (porcentajePerdida < 0) {
      // si ya est√°s por encima del "ideal", no hace falta aumento 
      porcentajePerdida = 0;
    }
  }


  // 4) P√©rdida acumulada sumando mes a mes (usando IPC + Varsueldo si est√°n disponibles)
  let perdidaTotal = 0;
  const perYearLoss = {};

  if (
    normalizedIndices.length > 1 &&
    IPC_FACTOR > 0 &&
    normalizedYears.length === normalizedIndices.length &&
    salaryIndexNorm.length > 0 &&
    salaryYearMonth.length === salaryIndexNorm.length
  ) {
    // Mapas para encontrar el √≠ndice por a√±o-mes
    const mapIPC = new Map();  // "YYYY-MM" -> √≠ndice en IPC
    for (let i = 0; i < ipcYearMonth.length; i++) {
      mapIPC.set(ipcYearMonth[i], i);
    }

    const mapSAL = new Map();  // "YYYY-MM" -> √≠ndice en salario
    for (let i = 0; i < salaryYearMonth.length; i++) {
      mapSAL.set(salaryYearMonth[i], i);
    }

    // Recorremos todos los meses donde tenemos IPC y salario a la vez
    for (const [ym, idxIPC] of mapIPC.entries()) {
      const idxSAL = mapSAL.get(ym);
      if (idxSAL == null) continue;      // si falta salario para ese mes, lo salteamos
      if (idxIPC === 0) continue;        // saltamos la base (dic-2015)

      const factorIPC = normalizedIndices[idxIPC];   // IPC_t / IPC_base
      const factorSal = salaryIndexNorm[idxSAL];     // Salario_t / Salario_base (escalado)

      const salarioIdealMes = salarioBaseEstimado * factorIPC;
      const salarioRealMes  = salarioBaseEstimado * factorSal;
      const diff = salarioIdealMes - salarioRealMes;

      if (diff > 0) {
        perdidaTotal += diff;

        const year = normalizedYears[idxIPC];
        if (!perYearLoss[year]) perYearLoss[year] = 0;
        perYearLoss[year] += diff;
      }
    }
  } else {
    // fallback simple si no tenemos series suficientes: aprox = p√©rdida mensual * 96 meses (~8 a√±os)
    const mesesAprox = 96;
    perdidaTotal = perdidaMensual * mesesAprox;

    const yearStartFallback = 2016;
    const yearEndFallback = CURRENT_YEAR;
    const yearsFallback = yearEndFallback - yearStartFallback + 1;
    const approxPerYear = perdidaTotal / yearsFallback;
    for (let y = yearStartFallback; y <= yearEndFallback; y++) {
      perYearLoss[y] = approxPerYear;
    }
  }

  // Mostrar contadores principales
  bloquePerdidas.style.display = "block";

  // 1) Deber√≠as estar ganando hoy (contador principal)
  animateMoneyCounter(contadorDeberia, Math.round(salarioNecesarioHoy), { negative: false });

  // 2) P√©rdida mensual (rojo, con "-")
  animateMoneyCounter(contadorPerdidaMensual, Math.round(perdidaMensual), { negative: true });

  // 3) P√©rdida total acumulada (rojo, con "-")
  animateMoneyCounter(contadorPerdidaTotal, Math.round(perdidaTotal), { negative: true });

// Mostrar el porcentaje de crecimiento TOTAL (100% + aumento necesario)
if (porcentajePerdida > 0) {
  porcentajePerdidaWrapper.style.display = "block";

  // porcentajePerdida es el aumento necesario vs tu sueldo actual
  // Para mostrar "crecer un XXX %", sumamos 100:
  const porcentajeCrecimientoTotal = 100 + porcentajePerdida;

  porcentajePerdidaSpan.textContent =
    formatoPorcentaje.format(porcentajeCrecimientoTotal) + " %";
}


  
  // 5) P√©rdida por a√±o en tabla: columnas = a√±os, filas = p√©rdida / inflaci√≥n / paritarias
  const yearStart = 2016;  // si quer√©s arrancar en 2017, cambi√° esto
  const yearsInData = Object.keys(perYearLoss).map(y => parseInt(y, 10));
  const maxYearInData = yearsInData.length ? Math.max(...yearsInData) : CURRENT_YEAR;
  const yearEnd = Math.min(CURRENT_YEAR, maxYearInData);

  if (yearEnd >= yearStart) {
    const MILL = 1_000_000; // divisor para pasar a millones

    // limpiamos el contenedor
    yearLossGrid.innerHTML = "";

    // creamos la tabla
    const table = document.createElement("table");
    table.className = "year-loss-table";

    // === THEAD: fila de a√±os ===
    const thead = document.createElement("thead");
    const headRow = document.createElement("tr");

    const emptyTh = document.createElement("th"); // celda vac√≠a para las etiquetas de fila
    emptyTh.textContent = "";
    headRow.appendChild(emptyTh);

    for (let y = yearStart; y <= yearEnd; y++) {
      const th = document.createElement("th");
      th.textContent = y;
      headRow.appendChild(th);
    }

    thead.appendChild(headRow);
    table.appendChild(thead);

    // === TBODY ===
    const tbody = document.createElement("tbody");

    // Fila 1: P√©rdida (Mill)
    const rowLoss = document.createElement("tr");
    const labelLoss = document.createElement("td");
    labelLoss.className = "year-loss-row-label";
    labelLoss.textContent = "P√©rdida (Mill)";
    rowLoss.appendChild(labelLoss);

    const countersLoss = []; // para animar despu√©s

    for (let y = yearStart; y <= yearEnd; y++) {
      const lossYear = perYearLoss[y] || 0;
      const lossYearEnMillones = lossYear / MILL;

      const td = document.createElement("td");
      const counter = document.createElement("div");
      counter.className = "counter counter-neg";
      counter.setAttribute("data-suffix", "");
      counter.textContent = "- 0,0 Mill";
      td.appendChild(counter);
      rowLoss.appendChild(td);

      countersLoss.push({ counter, value: lossYearEnMillones });
    }

    tbody.appendChild(rowLoss);

    // Fila 2: Inflaci√≥n (%)
    const rowInfl = document.createElement("tr");
    const labelInfl = document.createElement("td");
    labelInfl.className = "year-loss-row-label";
    labelInfl.textContent = "Inflaci√≥n (%)";
    rowInfl.appendChild(labelInfl);

    for (let y = yearStart; y <= yearEnd; y++) {
      const td = document.createElement("td");
      const infl = inflationByYear[y];
      td.textContent = (typeof infl === "number")
        ? formatoPorcentaje.format(infl) + " %"
        : "‚Äì";
      rowInfl.appendChild(td);
    }

    tbody.appendChild(rowInfl);

    // Fila 3: Paritarias (%)
    const rowSal = document.createElement("tr");
    const labelSal = document.createElement("td");
    labelSal.className = "year-loss-row-label";
    labelSal.textContent = "Paritarias (%)";
    rowSal.appendChild(labelSal);

    for (let y = yearStart; y <= yearEnd; y++) {
      const td = document.createElement("td");
      const varSal = salaryVariationByYear[y];
      td.textContent = (typeof varSal === "number")
        ? formatoPorcentaje.format(varSal) + " %"
        : "‚Äì";
      rowSal.appendChild(td);
    }

    tbody.appendChild(rowSal);

    table.appendChild(tbody);
    yearLossGrid.appendChild(table);

    // Animamos solo la fila de p√©rdidas (en millones)
    for (const item of countersLoss) {
      animateMillionsCounter(item.counter, item.value, { negative: true });
    }

    yearLossContainer.style.display = "block";
  }

});
</script>



<!-- ==== FIN GADGET PODER ADQUISITIVO ‚Äì SALARIO ACTUAL + 3 CONTADORES + A√ëO A A√ëO ==== -->

        </div> <!-- fin .calculadora-contenedor -->

        <!-- TARJETA LATERAL: Informe MATE Econom√≠a -->
        <div class="informe-mate">
          <a href="https://mateeconomia.com.ar/infomate/2025/octubre-2025/"
             target="_blank"
             class="informe-mate-link">
            <img src="Imagenes/MateInforme.PNG"
                 alt="Informe MATE Econom√≠a ‚Äì Octubre 2025"
                 class="informe-mate-img">
          </a>
          <h3>Informe de referencia</h3>
          <p>
            Para contextualizar la p√©rdida de poder adquisitivo frente a la inflaci√≥n, consult√° el informe de MATE Econom√≠a (octubre 2025)
          </p>
        </div>


      </div> <!-- fin .layout-calculadora-informe -->

      <!-- Video: una reproducci√≥n, con sonido al darle play, desde el minuto 44 -->
      <div class="hero-video">
        <iframe
          src="https://www.youtube.com/embed/GB7A7Iqzd5E?start=2580&rel=0&modestbranding=1"
          title="Video ATE ORSNA"
          allow="accelerometer; autoplay; encrypted-media; clipboard-write; picture-in-picture"
          allowfullscreen>
        </iframe>
      </div>
    </header>

  
    <!-- JUNTA INTERNA -->
    <section id="junta-interna">
      <h2>Junta Interna</h2>
      <p>
        Integran la Junta Interna, organizaci√≥n de la
        representaci√≥n gremial dentro del ORSNA, y principales
        l√≠neas de trabajo: defensa salarial, condiciones de trabajo, convenios,
        organizaci√≥n por sectores, etc.
      </p>

      <div class="grid" style="margin-top:14px;">
        <article class="card">
          <span class="tag">Representaci√≥n</span>
          <h3>Delegadas y delegados</h3>
          <p>Listado de representantes por √°rea, contacto b√°sico y referencias.</p>
        </article>
        <article class="card">
          <span class="tag">Trabajo</span>
          <h3>Comisiones y equipos</h3>
          <p>CIOT, CyMAT, g√©nero y diversidad, formaci√≥n, comunicaci√≥n, entre otras comisiones.</p>
        </article>
      </div>
    </section>


    <section id="trivia">
  <h2>Trivia sindical (ATE ORSNA)</h2>
  <p>Aprend√© jugando: derechos laborales, organizaci√≥n sindical, perspectiva de g√©nero y Estado presente.</p>

  <div id="triviaApp" class="trivia-card">
    <div id="triviaStart" class="trivia-start">
      <button id="btnStartTrivia" class="trivia-btn primary">Empezar</button>
      <div class="trivia-meta" id="triviaMeta"></div>
    </div>

    <div id="triviaGame" class="trivia-game" style="display:none;">
      <div class="trivia-top">
        <div id="triviaProgress" class="trivia-progress"></div>
        <div id="triviaScore" class="trivia-score"></div>
      </div>

      <div id="triviaQuestion" class="trivia-question"></div>
      <div id="triviaOptions" class="trivia-options"></div>

      <div id="triviaFeedback" class="trivia-feedback" style="display:none;"></div>

      <div class="trivia-actions">
        <button id="btnNext" class="trivia-btn" disabled>Siguiente</button>
        <button id="btnRestart" class="trivia-btn ghost" style="display:none;">Reiniciar</button>
      </div>
    </div>
  </div>
</section>

<link rel="stylesheet" href="Docs/trivia.css">
<script defer src="Docs/trivia.js"></script>

    <!-- PUBLICACIONES -->
    <section id="publicaciones">
      <h2>Publicaciones</h2>
      <p>
        En esta secci√≥n vas a poder subir comunicados, informes, actas y materiales
        producidos por la Junta Interna y Cuerpo de Delegades de ATE ORSNA.
      </p>

      <div class="grid">
        <article class="card">
          <span class="tag">Ejemplo</span>
          <h3>Comunicados</h3>
          <p>
            Comunicado de la Junta Interna. Este espacio se ir√°
            actualizando con materiales reales a medida que avance el sitio.
          </p>
        </article>

        <article class="card">
          <span class="tag">Informes</span>
          <h3>Informes y materiales</h3>
          <p>
            Enlaz√° ac√° informes en PDF, tableros, mapas u otros materiales que
            quieras compartir con las y los compa√±eros.
          </p>
        </article>
      </div>
    </section>

    <!-- CONTACTO -->
    <section id="contacto">
      <h2>Contacto</h2>
      <p>
        Datos de contacto
      </p>

      <ul class="contact-list">
        <li><strong>Correo general:</strong> ateorsna@gmail.com</li>
        <li><strong>Redes:</strong> IG @ateorsna</li>
        <li><strong>Presencial:</strong> Oficina de la Junta Interna en el ORSNA (6to piso T4 Aeroparque)</li>
      </ul>

      <p class="muted">
        Esta es una versi√≥n inicial de prueba.
      </p>
    </section>
  </main>


  
</body>
</html>
